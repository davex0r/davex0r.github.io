
<!doctype html>

<head>
	<script src="https://distill.pub/template.v2.js"></script>
	<link rel="stylesheet" href="https://distill.pub/third-party/katex/katex.min.css" crossorigin="anonymous">
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script src="https://unpkg.com/d3-simple-slider"></script>
	<script src="fminsearch.js"></script>
	<script crossorigin src="https://unpkg.com/wolfram-notebook-embedder@0.3/dist/wolfram-notebook-embedder.min.js"></script>
</head>

<d-title>
	<h1>Dimensionality in Biological Systems</h1>
	<p>Under Construciton!</p>
</d-title>

<body>


	<d-front-matter>
		<script id='distill-front-matter' type="text/json">{
			"title": "Title",
			"description": "Description",
			"published": "",
			"authors": [
				{
					"author":"David Jordan",
					"authorURL":"http://foo.org/",
					"affiliations": [{"name": "The Gurdon Institute", "url": "http://www.gurdon.cam.ac.uk"}]
				}
			],
			"katex": {
				"delimiters": [
					{"left": "$$", "right": "$$", "display": false}
				]
			}
		}</script>
	</d-front-matter>

	<d-article>

		<p>
		  <d-toc prerendered="false">
		  <style>
		  d-toc {
		    contain: layout style;
		    display: block;
		  }
		  d-toc ul {
		    padding-left: 0;
		  }
		  d-toc ul > ul {
		    padding-left: 24px;
		  }
		  d-toc a {
		    border-bottom: none;
		    text-decoration: none;
		  }
		  </style>

		  <nav role="navigation" class="table-of-contents"></nav>
		  <h2>Table of contents</h2>

		  <ul style="list-style-type:none;">
				<li><a href="#introduction">Introduction</a></li>
			</ul>

		  <ul style="list-style-type:none;">
				<li><a href="#parameter_spaces">Parameter Spaces</a></li>
				<li><a href="#phenotypespaces">Parameter Spaces for Biological Phenotypes</a></li>
				<ul style="list-style-type:none;">
					<li><a href="#modelbased">Model Based Parameter Spaces</a></li>
				</ul>
				<li><a href="#datadriven">Deriving Parameter Spaces from Data</a></li>
				<ul style="list-style-type:none;">
					<li><a href="#locality">Locality</a></li>
				</ul>
			</ul>
		  </p>

		<h2 id="introduction">Introduction</h2>
		<p>
		  When one looks at the natural world, the diversity of biological form and function is often striking.  We suspect, and evidence supports <d-cite key="theobald2010formal"></d-cite>, that existing biological forms (fish, trees, birds, ants, and humans e.g.) have arisen from a common ancestor.  Evolutionary theory, laid out in Charles Darwin's 1859 "On the Origin of Species", describes a procedure whereby populations adapt to changing environments by introducing modifications into the forms or functions of their offspring. If these modifications provide advantages, those individuals carrying them will be more likely to survive and reproduce.  This routine, descent with modification followed by natural selection, repeated faithfully since life first arose on earth, is thought to have produced all of the diversity of biological forms and functions, so-called phenotypic diversity, that we today observe.

		  While this procedure provides a powerful algorithmic description of the process of evolution, it does not easily provide quantitative predictions.  For example, geological estimates put the age of the earth at 4.54 billion years old, if, however, this were to be proved wrong by three orders of magnitude, no current evolutionary theory makes predictions about whether the current amount of phenotypic diversity we observe is possible or not.  In fact, it is unclear even how one might define an "amount of phenotypic diversity".
		</p>

		<h2 id="parameter_spaces">Parameter Spaces</h2>
		<p>As a concrete example, let us imagine that there is an organism which takes a triangular shape as its phenotype and that we would like to quantify the phenotypic diversity of a population of such creatures.  A triangle is the simplest geometric shape, however, there are an infinite number of different triangles.  A rigorous definition of diversity must be able to answer questions such as, "of the possible triangular shapes, what fraction is represented in our sample?". This analogy highlights some of the difficulties in defining phenotypic diversity.  We could count the number of different triangles that are grossly different (distinct "species" of triangle) but this definition relies on a subjective notion of what constitutes a gross difference.  Furthermore, it is impossible to define whether any given number of "species" is large or small.</p>

		<p>Parameter spaces provide one method to rigorously define the diversity of triangular shapes.  Instead of asking how many different phenotypes exist, we can in this case ask, how many different triangles exist?  On the one hand, intuition tells us that triangles are geometrically simple, on the other, there are an infinite number of different triangles.  The question then perhaps is not how many different triangles are there, but rather how many parameters does one need to capture all the variation among different triangles.  If we ignore size, and are only interested in capturing differences in shape, then the minimum number of parameters needed turns out to be two<d-cite key="edelman2015random"></d-cite>, which aligns with our intuition that triangles are relatively simple.  Thus instead of trying to answer the question - how many phenotypes are there - instead we can look for a parameter space that captures all the phenotypic diversity and to see how many parameters comprise it.  In the following sections, we will explore two aspects of triangular shape space, first, how different parameterizations lead naturually to different insights, and second, the role of different random distributions placed onto the parameter space.</p>

		<p>To illustrate how we can reformulate questions rigourously with a well-defined parameter space, we will look at a problem that was given by Lewis Carroll, author and mathematician, in his collection of "Pillow Problems"<d-cite key="carroll1958mathematical"></d-cite>;
		</p>

		<blockquote>58. (25,83) Three points are taken at random on an infinite plane, find the chance of their being the vertices of an obtuse angled triangle. [20.1.84]</blockquote>

		<p>From this problem we can recognize another natural parameterization of the triangles, the six-parameter space given by the x and y coordinates of the three vertices in the plane.  This  highlights an important aspect of parameter spaces, i.e. many different, equally valid parameterizations exist, and the number of parameters in these different spaces will vary. Earlier I stated that triangle shape space can be captured with two parameters and in fact two is the minimum number of parameters needed.  To understand this six-parameter representation <d-math>{(x_i,y_i), i\in[1, 2, 3]}</d-math>, we must note that there are many unique sets of these parameters that give equivalently shaped triangles.  These sets, or equivalence classes, differ only by translations or rotattions in the plane, or by uniform sclaing.  In fact, if we take into account these symmetries, we can recover a two-parameter space from this natural parameterization.</p>

		<figure style="grid-column: page; margin: 1rem 0;"><img src="parameterReduction.png" style="width:100%; border: 0px solid rgba(0, 0, 0, 0.2);"/>
			<figcaption style="grid-column: kicker">
			      <p>
							Figure 1. Here we can visualize using symmetry transformations to reduce the number of parameters from the naive representation.  Given any triangle (a,blue) we can first translate it to have a vertex at the origin (orange).  This reduces from 6 parameters to 4.  Next (b) we can define a rotation to bring one edge to lay along the x-axis (yellow).  Finally (c), we can scale this edge to have unit length (purple).<d-footnote>Start with any triangle given by three points <d-math>(x_1,y_1),(x_2,y_2),(x_3,y_3)</d-math>.  First translate by subtracting <d-math>(x_1,x_2)</d-math> from each point resulting in  <d-math>(0,0),x_2-x_1,y_2-y_1),(x_3-x_1,y_3-y_1)</d-math>.  Next we can define a rotation matrix to align one edge with the x-axis.  If <d-math>s=\sqrt{(x_2-x_1)^2+(y_2-y_1)^2)}</d-math>
								<dt-math block="">
      						T =\frac{1}{s}
									\begin{bmatrix}
									(x_2-x_1) & (y_2-y_1) \\
									-(y_2-y_1) & (x_2-x_1)
									\end{bmatrix}
  							</dt-math>
						If we let <d-math>x_i^{\prime}=(x_i-x_1)</d-math> and likewise for y, after rotation the coordinates are

						<d-math block = "">
							(0,0),(s,0),(\frac{x_2^{\prime}x_3^{\prime}-y_2^{\prime}y_3^{\prime}}{s},\frac{x_3^{\prime}y_2^{\prime}-x_2^{\prime}y_3^{\prime}}{s})
						</d-math>

						Finally we can normalize the edge lying along the x-axis by its length s, to give a two-parameter representaiton as follows:

						<d-math block = "">
							(0,0),(1,0),(\frac{x_2^{\prime}x_3^{\prime}-y_2^{\prime}y_3^{\prime}}{s^2},\frac{x_3^{\prime}y_2^{\prime}-x_2^{\prime}y_3^{\prime}}{s^2})
						</d-math>

						</d-footnote>
			      </p>
			    </figcaption>
		</figure>

		<p>Another way to generate a two parameter space of the triangles is to compute from the coordinates the lengths of the three sides, <d-math>l_{ij}=\sqrt{(x_i-x_j)^2+(y_i-y_j)^2}</d-math>.  If we denote the three sides <d-math>(a,b,c)</d-math>, we have recovered a three-parameter space by accounting for the translational and rotational symmetries.  Finally, we account for the scaling symmetry by normalizing each triangle to have unit perimeter <d-math>a+b+c=1</d-math>, a constraint which recovers a two-dimensional parameter space (the standard 2-simplex in <d-math>\mathbb{R}^3</d-math>).  We could, of course, choose other normalization conditions, one of particular interest is the normalization of <d-math>a^2+b^2+c^2=1</d-math></p>

		<p> Let's return now to Carroll's original problem, and consider what fraction of random triangles are obtuse.  The answer, or rather answers, to this question, will depend on how we choose to define "random", and we will see how the parameterization can aid us in both computing the answer and determining a natural random distribution.  Let's first consider different possible parameterizations we could generate for triangles</p>


		<h2 id="phenotypespaces">Parameter Spaces for Biological Phenotypes</h2>
		<p>Triangles are simple geometric shapes, and it may not be so surprising that their complexity can be captured with only two parameters.  Biological phenotypes are seemingly much more complex, and one may wonder whether such a low-dimensional description is possible. It seems that in some cases this is possible.  There are examples of low-dimensional shape-spaces in bird beaks<d-cite key="campas2010scaling"></d-cite> (two-parameter), plant inflorescence architectures<d-cite key="prusinkiewicz2007evolution"></d-cite> (two-parameter), sea-shells<d-cite key="raup1965theoretical,raup1966geometric"></d-cite> (four-parameter), and even the shape of the influenza antigen protein<d-cite key="lapedes2001geometry,smith2004mapping"></d-cite> (five-parameter). In addition to these morphological phenotypes, which are relatively fixed after development, phenotypes which are time-varying and respond to stimuli of short time scales, such as swimming behaviors in microbes <d-cite key="jordan2013behavioral"></d-cite>
		and crawling in the nematode C. elegans<d-cite key="stephens2008dimensionality"></d-cite>, can also be captured with a few parameters (two and six respectively)</p>

		<h3 id="modelbased"> Model Based Parameter Spaces</h3>
		<h4> An example from sea-shell morphopspace</h4>

		<p> In this section we will look at the morphospace of sea-shells to understand how parameter spaces can capture phenotypic diversity, and to see how this description leads to some natural quantifications. First let us introduce the four-parameter shell morphospace of Raup and colleagues. This model of shell shape is a geometric model, and the four parameters are given as the shape of a generating curve (S), the rate of expansion of this generating curve (W) as it is translated along an axis (T), and the rate of increase of the displacement of the generating curve from the axis of rotation (D)<d-cite key="fowler1992modeling"></d-cite> Below is an interactive demonstration that allows you to choose the parameters and shows the resulting shell shape <d-cite key="ramsdenshellspace"></d-cite> </p>

		<script crossorigin src="https://www.wolframcdn.com/notebook-embedder/0.1/wolfram-notebook-embedder.js"></script>
		<div id="2016546f-c2fc-4649-8800-fccbb2a2521b-48659-52548"></div>
		<script>
			WolframNotebookEmbedder.embed(
				"https://www.wolframcloud.com/obj/demonstrations/Published/ShellSpaceFlareVermAndSpire",
				document.getElementById("2016546f-c2fc-4649-8800-fccbb2a2521b-48659-52548"), {allowInteract: true}
			);
		</script>

		<h3 id="datadriven"> Deriving Parameter Spaces from Data</h3>
		<h4>Back to Triangle Shape Space</h4>

		<p> In this section we would like to introduce a general procedure for learning phenotypic parameter spaces from data<d-footnote>This section based on the work of Macleod<d-cite key="macleodpalaeomath"></d-cite>.</d-footnote>.  It has three essential components, first a quantitative description of the phenotype of interest, next a measure of similarity between different pehnotypes, and finally a method of dimensionality reduction.</p>

		<div class = "l-body" id="grid"></div>
		<script type="text/javascript" src="apex.js"></script>


		<h4>Influenza Shape Space: A Data Derived Phenotypic Space</h4>
		<p>Parameter spaces can be model based, as is the case for the bird beaks and seas-shells, or can be derived indirectly from similarity data, as is the case for the influenza antigen.  This procedure </p>


		<h2 id="locality"> Locality</h2>

		<p>Recall that another simple way to parameterize triangular shapes is to specify the length of two sides and the angle between them.  Box 1 allows you to change the length of the l1 and l2 as well as the angle <d-math>\theta</d-math>, and shows the resulting triangular shape.  The entirety of triangular shape space can be described with these three parameters, knobs that can tuned to give any shape.  This three-parameter space is more consistent with our notion that triangular shapes are geometrically simple.</p>

		<svg width="100%" height="400" id="new_tps"></svg>

		<aside>A simple parameterization of triangular space using the lengths of two sides and the angle between them.  The lenghts here are limited, but should properly be <d-math>[0,\infty]</d-math>.  If we constrain the traingles to have a constant area, the three parameters are no longer independent, as <d-math>A=l_1l_2sin(\theta)</d-math></aside>

		<div>
		  <input type="checkbox" id="myCheckbox">
		  <label for="myCheckBox">Constant Area</label>
		  <br><br>
		  <button type="button" id="button1">Reset</button>
		  <br><br>
		</div>

		<script type="text/javascript" src="new_tps.js"></script>

		<p>The <d-math>l1,l2,\theta</d-math> parameter space of trianges is a simple and striaghtforward parameterization of triangular space which provides an intuitive way ask and answer some interesting questions in a strightforward manner.</p>

		<p>The parameterization we choose determines locality on the manifold, and trajectories through different parameter spaces give different sequences through shape space</p>

	</d-article>

	<d-appendix>
		<h3>Contributions</h3>
		<p>Some text describing who did what.</p>
		<h3>Reviewers</h3>
		<p>Some text with links describing who reviewed the article.</p>
		<d-bibliography src="./dimensionality_review.bib"></d-bibliography>
	</d-appendix>

</body>
